*******
Fluxing
*******

Overview
========
The code matches a standard star to you science target based on
the time(s) of observation. If multiple standard stars are
supplied as calibration frames, PYPIT selects the standard star
observed closest in time to your science observation for fluxing.

Sensitivity Function
====================
PYPIT uses the CALSPEC calibration database, which can be found
at http://stsci.edu/hst/observatory/crds/calspec.html for flux
calibrations, specifically, generating the sensitivity function.

The sensitivity function is generated by dividing the standard
star's flux, which is loaded in by PYPIT from CALSPEC, by the
standard star's counts per second. This is then multiplied to the
science object's counts per second to yield a fluxed science
spectrum.

Fluxing Output
==============

Science
-------
The resulting fluxed science spectrum, :math:`\rm f_\lambda`,
is given in units of :math:`10^{-17}\,\rm ergs/s/cm^2/Angstrom`
and is stored in the 'box_flam' extension of the extracted 1D
spectrum. If an optimal extraction was successful, there also
exists an 'opt_flam' extension in the 1D spectrum.

Standard
--------
The 1D extracted standard spectrum is also saved as an output
of the fluxing routine. The counts and fluxed standard spectrum
are available in the 'box_counts' and 'box_flam' extensions,
respectively. The fluxed spectrum saved here is the fluxed standard,
using the sensitivity function generated from itself (rather than
the archived fluxed standard star loaded from CALSPEC), and can be
examined and compared to the expected :math:`\rm f_\lambda` as a
sanity check.